<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">  
    <title>CoSSA Dues Records</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: #f8f9fa; color: #333; }
        .header { background: #0d47a1; color: white; padding: 25px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .container { max-width: 1000px; margin: 30px auto; padding: 20px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .search-bar { text-align: center; margin-bottom: 30px; }
        input[type="text"] { padding: 12px; width: 60%; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; }
        button { padding: 12px 25px; background: #0d47a1; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        button:hover { background: #08306b; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; }
        th { background-color: #f1f3f5; color: #0d47a1; text-transform: uppercase; font-size: 13px; }
        tr:hover { background-color: #fcfcfc; }
        .timestamp { text-align: center; font-size: 12px; color: #888; margin-top: 20px; }
        .logout { display: block; text-align: center; margin-top: 30px; color: #0d47a1; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header">
        <h1>CoSSA Portal</h1>
        <p>Student Dues Verification System</p>
    </div>

    <div class="container">
        <div class="search-bar">
            <form method="POST">
                <input type="text" name="search_value" placeholder="Enter ID or Full Name..." value="{{ search_value or '' }}">
                <button type="submit">Search Records</button>
            </form>
        </div>

        {% if record %}
        <table>
            <thead>
                <tr>
                    <th>ID</th><th>Name</th><th>Date</th><th>Amount</th><th>Method</th><th>Collector</th>
                </tr>
            </thead>
            <tbody>
                {% for row in record %}
                <tr>
                    <td>{{ row['ID'] }}</td>
                    <td>{{ row['NAME'] }}</td>
                    <td>{{ row.get('PAID DATE') or row.get('PAID SEMESTER') or '' }}</td>
                    <td>GHS {{ row['PAID AMOUNT'] }}</td>
                    <td>{{ row['PAYMENT METHOD'] }}</td>
                    <td>{{ row.get("COLLECTOR'S NAME") or row.get("COLLECTORâ€™S NAME") or '' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% elif search_value %}
            <p style="text-align:center; color: #d32f2f;">No records found for "{{ search_value }}". Please verify the ID/Name.</p>
        {% endif %}

        <p class="timestamp">Data last synced with Google Sheets: <strong>{{ last_updated }}</strong>. (The system refreshes data every 10 minutes to maintain speed.)</p>
        
        <a href="{{ url_for('logout') }}" class="logout">Logout & Exit</a>
    </div>
</body>
</html>